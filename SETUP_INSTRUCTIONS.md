# Инструкция по настройке Google Apps Script и переменных окружения

## Шаг 1: Настройка Google Apps Script

1. Откройте [Google Apps Script](https://script.google.com/)
2. Создайте новый проект или откройте существующий
3. Скопируйте код из файла `google-apps-script.js` и вставьте в редактор
4. Обновите константы в начале скрипта:
   - `SPREADSHEET_ID` - ID вашей Google Таблицы (из URL таблицы)
   - `DRIVE_FOLDER_ID` - ID папки в Google Drive для сохранения файлов
5. Сохраните проект (Ctrl+S / Cmd+S)
6. Разверните как веб-приложение:
   - Нажмите "Развернуть" → "Новое развертывание"
   - Выберите тип "Веб-приложение"
   - Выполните от имени: "Я"
   - У кого есть доступ: "Все"
   - Нажмите "Развернуть"
   - Скопируйте URL веб-приложения (это ваш `GOOGLE_SCRIPT_URL`)

## Шаг 2: Создание Google Таблицы

1. Создайте новую Google Таблицу
2. Скопируйте ID из URL (между `/d/` и `/edit`)
   - Пример URL: `https://docs.google.com/spreadsheets/d/ВАШ_ID_ТАБЛИЦЫ/edit`
   - ID таблицы: `ВАШ_ID_ТАБЛИЦЫ`
3. Убедитесь, что в таблице есть лист с названием "Заявки стартапов" (или измените `SHEET_NAME` в скрипте)

## Шаг 3: Создание папки в Google Drive

1. Создайте папку в Google Drive для хранения файлов заявок
2. Откройте папку
3. Скопируйте ID из URL (между `/folders/` и следующим `/`)
   - Пример URL: `https://drive.google.com/drive/folders/ВАШ_ID_ПАПКИ`
   - ID папки: `ВАШ_ID_ПАПКИ`

## Шаг 4: Обновление переменных окружения (.env)

Создайте или обновите файл `.env.local` в корне проекта:

```env
# Google Apps Script URL
GOOGLE_SCRIPT_URL=https://script.google.com/macros/s/ВАШ_СКОПИРОВАННЫЙ_URL/exec

# Email настройки для отправки уведомлений
EMAIL_USER=ваш_email@gmail.com
EMAIL_PASSWORD=ваш_пароль_приложения

# Базовый URL приложения (для ссылок в email)
NEXT_PUBLIC_BASE_URL=http://localhost:3000
```

### Как получить пароль приложения для Gmail:

1. Войдите в ваш Google аккаунт
2. Перейдите в [Настройки безопасности](https://myaccount.google.com/security)
3. Включите двухфакторную аутентификацию (если еще не включена)
4. Перейдите в [Пароли приложений](https://myaccount.google.com/apppasswords)
5. Выберите "Почта" и "Другое устройство"
6. Введите название: "Flow Capital"
7. Скопируйте сгенерированный пароль (16 символов)
8. Используйте этот пароль как `EMAIL_PASSWORD`

## Шаг 5: Проверка работы

1. Убедитесь, что dev сервер запущен: `npm run dev`
2. Откройте форму стартапа в браузере
3. Заполните тестовую заявку
4. Отправьте форму
5. Проверьте:
   - Данные появились в Google Таблице
   - Файлы сохранены в папке Google Drive
   - Email уведомление отправлено (проверьте спам)

## Структура данных в таблице

Таблица будет содержать следующие колонки:
1. Дата заявки
2. ID заявки
3. Название стартапа
4. Контактное лицо (ФИО)
5. Email
6. Контактный телефон
7. Отраслевая экспертиза
8. Полнота команды
9. Опишите ваш продукт
10. Наличие продукта
11. Аудитория продукта
12. Уникальное торговое предложение
13. Наличие исследований
14. Технологическая масштабируемость
15. Размер рынка
16. Текущие продажи
17. Текущие расходы
18. Текущие пользователи
19. Запрашиваемая сумма инвестиций
20. Какой % компании вы готовы продать
21. План использования инвестиций
22. Масштабируемость проекта (географическая)
23. Текущие инвестиции и структура капитала
24. Структура капитала
25. Оценка компании
26. Рыночные риски
27. Операционные риски
28. Регистрация компании
29. Лицензии и регуляторное соответствие
30. Что ограничивает компанию от роста до единорога
31. Ссылка на папку с файлами
32. Ссылка на резюме команды
33. Ссылка на финансовую модель
34. Ссылка на дополнительные документы

## Файлы сохраняются в Google Drive:

- Папка создается для каждой заявки: `Заявка_[ID]_[Название компании]`
- В папке сохраняются:
  - `Резюме_команды_[ID]` - резюме команды
  - `Финансовая_модель_[ID]` - финансовая модель
  - `Дополнительные_документы_[ID]` - дополнительные документы

## Устранение неполадок

### Ошибка доступа к таблице
- Убедитесь, что скрипт запущен от вашего имени
- Проверьте, что ID таблицы правильный

### Файлы не сохраняются
- Проверьте права доступа к папке в Google Drive
- Убедитесь, что ID папки правильный
- Проверьте логи выполнения в Google Apps Script (Вид → Логи выполнения)

### Email не отправляется
- Проверьте, что пароль приложения правильный
- Убедитесь, что двухфакторная аутентификация включена
- Проверьте, что EMAIL_USER и EMAIL_PASSWORD установлены в .env.local

