# Настройка дашборда Flow.Capital

## Обзор

Дашборд позволяет просматривать заявки стартапов и результаты их скоринга. Данные автоматически загружаются из Google Sheets.

## Структура данных в Google Sheets

### Лист "Заявки с лендинга"

Этот лист уже настроен и содержит все данные заявок стартапов. Структура колонок сохранена без изменений.

### Отдельная таблица "Скоринг"

Скоринг хранится в **отдельной Google Таблице** для сохранения логики основной таблицы с заявками.

**ID таблицы скоринга:** `1Q2DMl-r7MZmpNNdYlj1y6jvGJcjgnVrUmHtbNm-r-O0`

Создайте лист с именем **"Скоринг"** в этой таблице.

#### Структура колонок листа "Скоринг"

Для связи с заявками используется колонка **`Название стартапа`** - название стартапа из листа "Заявки стартапов".

**Полная структура колонок:**

1. **`Дата скоринга`** - дата анализа
2. **`Название стартапа`** - название стартапа для связи с заявкой
3. **`ФИО`** - ФИО контактного лица
4. **`Email`** - email контактного лица
5. **`Контактный телефон`** - контактный телефон
6. **`Общий скоринг`** - число от 0 до 100
7. **`Скоринг - Интро`** - число от 0 до 100
8. **`Скоринг - Команда`** - число от 0 до 100
9. **`Скоринг - Продукт`** - число от 0 до 100
10. **`Скоринг - Финансы`** - число от 0 до 100
11. **`Скоринг - Риски`** - число от 0 до 100
12. **`Анализ от модели`** - текстовый анализ и рекомендации от модели

> **Примечание:** Структура колонок будет дорабатываться при реализации визуальной части на основе дизайна из Figma.

#### Пример структуры листа "Скоринг"

| Дата скоринга | Название стартапа | ФИО | Email | Контактный телефон | Общий скоринг | Скоринг - Интро | Скоринг - Команда | Скоринг - Продукт | Скоринг - Финансы | Скоринг - Риски | Анализ от модели |
|---------------|------------------|-----|------|-------------------|---------------|-----------------|-------------------|-------------------|------------------|----------------|------------------|
| 2025-01-15    | Название компании | Иван Иванов | ivan@example.com | +7 999 123 45 67 | 75            | 80              | 70                | 80                | 75               | 70             | Анализ текста... |

## Настройка переменных окружения

Создайте файл `.env.local` в корне проекта (если его еще нет) и добавьте следующие переменные:

```env
# Google Apps Script URL (уже должен быть настроен для заявок)
GOOGLE_SCRIPT_URL=https://script.google.com/macros/s/ВАШ_СКОПИРОВАННЫЙ_URL/exec

# Email настройки для отправки уведомлений (если используете)
EMAIL_USER=ваш_email@gmail.com
EMAIL_PASSWORD=ваш_пароль_приложения

# Базовый URL приложения (для ссылок в email)
NEXT_PUBLIC_BASE_URL=http://localhost:3000

# Учетные данные для доступа к дашборду
DASHBOARD_USERNAME=admin
DASHBOARD_PASSWORD=your_secure_password
```

### Настройка Google Apps Script для дашборда

**Важно:** Для безопасности основной логики используется отдельный скрипт для чтения данных дашборда.

1. Создайте новый Google Apps Script проект:
   - Откройте [Google Apps Script](https://script.google.com/)
   - Нажмите "Новый проект"
   - Назовите проект "Flow Capital Dashboard Reader"

2. Скопируйте код из файла `google-apps-script-dashboard.js` и вставьте в редактор

3. Обновите константы в начале скрипта:
   ```javascript
   const STARTUP_SPREADSHEET_ID = 'ВАШ_ID_ТАБЛИЦЫ_С_ЗАЯВКАМИ'; // Или оставьте пустым, если скрипт привязан к таблице
   const SCORING_SPREADSHEET_ID = '1Q2DMl-r7MZmpNNdYlj1y6jvGJcjgnVrUmHtbNm-r-O0';
   ```

4. Разверните скрипт как веб-приложение:
   - Нажмите "Развернуть" → "Новое развертывание"
   - Выберите тип "Веб-приложение"
   - Описание: "Flow Capital Dashboard API"
   - Выполнять от имени: **"Я"** (ваш email)
   - У кого есть доступ: **"Все"**
   - Нажмите "Развернуть"
   - Скопируйте URL веб-приложения

5. Добавьте URL в `.env.local`:
   ```env
   GOOGLE_SCRIPT_DASHBOARD_URL=https://script.google.com/macros/s/ВАШ_СКОПИРОВАННЫЙ_URL/exec
   ```

6. Предоставьте доступ к таблицам:
   - Откройте таблицу с заявками
   - Нажмите "Поделиться"
   - Добавьте email аккаунта, от имени которого выполняется скрипт
   - Дайте права "Читатель" или "Редактор"
   - Повторите для таблицы скоринга (ID: `1Q2DMl-r7MZmpNNdYlj1y6jvGJcjgnVrUmHtbNm-r-O0`)

## Доступ к дашборду

1. Откройте `/login` в браузере
2. Введите учетные данные (из переменных окружения)
3. После успешного входа вы будете перенаправлены на `/dashboard`

## Возможности дашборда

### Главная страница (`/dashboard`)

- **Метрики:**
  - Общее количество заявок
  - Количество проанализированных заявок
  - Средний скоринг
- **Таблица стартапов:**
  - Список всех заявок
  - Отображение скоринга (если доступен)
  - Ссылка на детальную страницу

### Детальная страница стартапа (`/dashboard/startup/[id]`)

- Общий скоринг с визуализацией
- Детальный анализ от модели (если доступен)
- Разбивка по секциям с отдельными скорингами:
  - Интро
  - Команда
  - Продукт и технологии
  - Финансы
  - Риски
  - Завершение
- Ссылки на файлы (если загружены)

## Дальнейшая доработка

При реализации визуальной части на основе дизайна из Figma будут добавлены:
- Дополнительные метрики и показатели
- Графики и визуализации
- Расширенная структура данных скоринга
- Фильтры и сортировка

## Обновление структуры данных

Если вы измените структуру колонок в листе "Скоринг", обновите:
1. Функцию `getScoringData()` в `/src/lib/googleSheetsReader.ts`
2. Компоненты отображения в `/src/app/dashboard/`

## Поддержка

При возникновении проблем проверьте:
- Правильность настроенных переменных окружения
- Доступ Service Account к Google Таблице
- Имена листов в Google Sheets (должны точно совпадать)
- Формат данных в листе "Скоринг"

