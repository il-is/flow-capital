# Исправление загрузки файлов в Google Drive

## Что было исправлено:

1. **Передача оригинальных имен файлов** - теперь файлы сохраняются с оригинальными именами и расширениями
2. **Улучшено определение MIME типов** - корректно определяются DOCX, XLSX, PPTX файлы
3. **Добавлены проверки** - проверка на пустые данные перед сохранением
4. **Расширенное логирование** - добавлены логи для диагностики проблем

## Что нужно сделать:

### 1. Обновить Google Apps Script

1. Откройте Google Apps Script (https://script.google.com/)
2. Найдите проект для вашего веб-приложения
3. Скопируйте содержимое файла `google-apps-script.js` из репозитория
4. Вставьте в редактор Google Apps Script
5. Нажмите "Сохранить" (Ctrl+S / Cmd+S)
6. Нажмите "Развернуть" → "Новая версия"
7. Убедитесь, что версия развернута

### 2. Проверить на тестовой среде

После обновления скрипта:
- Отправьте тестовую заявку с файлами (резюме команды и финансовая модель)
- Проверьте логи в Google Apps Script (Выполнение → Просмотр журналов выполнения)
- Проверьте папку в Google Drive - файлы должны появиться с оригинальными именами

### 3. Проверка логов

В логах Google Apps Script должны появиться сообщения:
- `Received POST request`
- `Files data check:` (показывает, какие файлы получены)
- `Saving file to Drive:` (для каждого файла)
- `File created successfully:` (с URL файла)

Если файлы не сохраняются, проверьте логи на наличие ошибок.

